# docker feathers config
FROM container-registry.example.com/library/nodejs-12-lts:latest

ENV APP_SERVER_HOST=
ENV APP_SERVER_PORT=
ENV APP_SERVER_ENV=
ENV APP_WORKDIR=
ENV NODE_ENV=
ENV HOST=
ENV PORT=
ENV POSTGRES_USERNAME=
ENV POSTGRES_PASSWORD=
ENV POSTGRES_DBNAME=
ENV POSTGRES_HOST=
ENV POSTGRES_PORT=
ENV POSTGRES_CONNECTION_QUERY_STRING=
ENV KAFKA_BOOTSTRAP_SERVERS=
ENV POSTGRES_URI=
ENV REDIS_HOST=
ENV REDIS_PORT=
ENV REDIS_PASSWORD=
ENV SENDGRID_URL=
ENV SENDGRID_FROM_EMAIL=
ENV SENDGRID_API_KEY=
ENV REDIS_CACHE=
ENV HTTPS=

WORKDIR /app
COPY package.json /app/package.json
RUN yarn install 2> /dev/null
COPY . /app
EXPOSE 5000
ENTRYPOINT [ "/bin/sh", "/app/run.sh" ]